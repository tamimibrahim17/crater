var Be=Object.defineProperty,Ie=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var me=Object.getOwnPropertySymbols;var Te=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable;var pe=(t,s,e)=>s in t?Be(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,z=(t,s)=>{for(var e in s||(s={}))Te.call(s,e)&&pe(t,e,s[e]);if(me)for(var e of me(s))ke.call(s,e)&&pe(t,e,s[e]);return t},X=(t,s)=>Ie(t,Pe(s));import{q as ee,c as J,e as ye,b as te,p as xe,g as ne,T as Ce,k as Me,u as Ae,d as Ve}from"./main.d5991eaa.js";import{D as De,d as je}from"./DragIcon.13b77dd4.js";import{B as Y,a0 as fe,ah as ae,C as Z,k as S,Y as re,r as p,o as l,e as v,h as a,t as _,f as n,Q as qe,u as o,w as c,i as U,l as D,j as N,z as Ue,X as G,E as L,H as Q,b2 as ge,N as oe,aX as Ne,O as le,x as H,F as K,y as se,G as he,a7 as Oe,R as Le,m as W,T as Ee,S as ze,U as Fe,I as Re,Z as _e,P as be}from"./vendor.0449769e.js";import{_ as Xe}from"./SelectNotePopup.874c61ad.js";const Ye={class:"flex items-center justify-between mb-3"},Qe={class:"flex items-center text-base",style:{flex:"4"}},We={class:"pr-2 mb-0",align:"right"},Je={class:"absolute left-3.5"},Ze={class:"ml-2 text-sm leading-none text-primary-400 cursor-pointer"},Ge=a("br",null,null,-1),He={class:"text-sm text-right",style:{flex:"3"}},Ke={class:"flex items-center justify-center w-6 h-10 mx-2 cursor-pointer"},et={props:{ability:{type:String,default:""},store:{type:Object,default:null},storeProp:{type:String,default:""},itemIndex:{type:Number,required:!0},index:{type:Number,required:!0},taxData:{type:Object,required:!0},taxes:{type:Array,default:[]},total:{type:Number,default:0},totalTax:{type:Number,default:0},currency:{type:[Object,String],required:!0},updateItems:{type:Function,default:()=>{}}},emits:["remove","update"],setup(t,{emit:s}){const e=t,d=ee(),w=J(),$=ye(),B=Y(null),y=fe(z({},e.taxData));ae("utils");const{t:C}=Z(),m=S(()=>d.taxTypes.map(h=>z({},h)).map(h=>(e.taxes.find(x=>x.tax_type_id===h.id)?h.disabled=!0:h.disabled=!1,h))),j=S(()=>y.compound_tax&&e.total?(e.total+e.totalTax)*y.percent/100:e.total&&y.percent?e.total*y.percent/100:0);re(()=>e.total,()=>{T()}),re(()=>e.totalTax,()=>{T()}),e.taxData.tax_type_id>0&&(B.value=d.taxTypes.find(u=>u.id===e.taxData.tax_type_id)),T();function V(u){y.percent=u.percent,y.tax_type_id=u.id,y.compound_tax=u.compound_tax,y.name=u.name,T()}function T(){y.tax_type_id!==0&&s("update",{index:e.index,item:X(z({},y),{amount:j.value})})}function i(){let u={itemIndex:e.itemIndex,taxIndex:e.index};w.openModal({title:C("settings.tax_types.add_tax"),componentName:"TaxTypeModal",data:u,size:"sm"})}function r(u){e.store.$patch(h=>{h[e.storeProp].items[e.itemIndex].taxes.splice(u,1)})}return(u,h)=>{const M=p("BaseIcon"),x=p("BaseMultiselect"),A=p("BaseFormatMoney");return l(),v("div",Ye,[a("div",Qe,[a("label",We,_(u.$t("invoices.item.tax")),1),n(x,{modelValue:B.value,"onUpdate:modelValue":[h[0]||(h[0]=k=>B.value=k),h[1]||(h[1]=k=>V(k))],"value-prop":"id",options:o(m),placeholder:u.$t("general.select_a_tax"),"open-direction":"top","track-by":"name",searchable:"",object:"",label:"name"},qe({singlelabel:c(({value:k})=>[a("div",Je,_(k.name)+" - "+_(k.percent)+" % ",1)]),option:c(({option:k})=>[U(_(k.name)+" - "+_(k.percent)+" % ",1)]),_:2},[o($).hasAbilities(t.ability)?{name:"action",fn:c(()=>[a("button",{type:"button",class:"flex items-center justify-center w-full px-2 cursor-pointer py-2 bg-gray-200 border-none outline-none",onClick:i},[n(M,{name:"CheckCircleIcon",class:"h-5 text-primary-400"}),a("label",Ze,_(u.$t("invoices.add_new_tax")),1)])])}:void 0]),1032,["modelValue","options","placeholder"]),Ge]),a("div",He,[n(A,{amount:o(j),currency:t.currency},null,8,["amount","currency"])]),a("div",Ke,[t.taxes.length&&t.index!==t.taxes.length-1?(l(),D(M,{key:0,name:"TrashIcon",class:"h-5 text-gray-700 cursor-pointer",onClick:h[2]||(h[2]=k=>r(t.index))})):N("",!0)])])}}},tt={class:"box-border bg-white border border-gray-200 border-solid rounded-b"},st={colspan:"5",class:"p-0 text-left align-top"},ot={class:"w-full"},nt=a("col",{style:{width:"40%","min-width":"280px"}},null,-1),at=a("col",{style:{width:"10%","min-width":"120px"}},null,-1),rt=a("col",{style:{width:"15%","min-width":"120px"}},null,-1),lt={key:0,style:{width:"15%","min-width":"160px"}},it=a("col",{style:{width:"15%","min-width":"120px"}},null,-1),dt={class:"px-5 py-4 text-left align-top"},ct={class:"flex justify-start"},ut={class:"flex items-center justify-center w-5 h-5 mt-2 text-gray-300 cursor-move handle mr-2"},mt={class:"px-5 py-4 text-right align-top"},pt={class:"px-5 py-4 text-left align-top"},yt={class:"flex flex-col"},xt={class:"flex-auto flex-fill bd-highlight"},ft={class:"relative w-full"},gt={key:0,class:"px-5 py-4 text-left align-top"},ht={class:"flex flex-col"},_t={class:"flex",style:{width:"120px"},role:"group"},bt={class:"flex items-center"},vt={class:"px-5 py-4 text-right align-top"},$t={class:"flex items-center justify-end text-sm"},wt={class:"flex items-center justify-center w-6 h-10 mx-2"},St={key:0},Bt=a("td",{class:"px-5 py-4 text-left align-top"},null,-1),It={colspan:"4",class:"px-5 py-4 text-left align-top"},Pt={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},itemData:{type:Object,default:null},index:{type:Number,default:null},type:{type:String,default:""},loading:{type:Boolean,default:!1},currency:{type:[Object,String],required:!0},invoiceItems:{type:Array,required:!0},itemValidationScope:{type:String,default:""}},emits:["update","remove","itemValidate"],setup(t,{emit:s}){const e=t,d=te(),w=xe();Ue();const{t:$}=Z(),B=S({get:()=>e.itemData.quantity,set:g=>{q("quantity",parseFloat(g))}}),y=S({get:()=>{const g=e.itemData.price;return parseFloat(g)>0?g/100:g},set:g=>{if(parseFloat(g)>0){let P=Math.round(g*100);q("price",P)}else q("price",g)}}),C=S(()=>e.itemData.price*e.itemData.quantity),m=S({get:()=>e.itemData.discount,set:g=>{e.itemData.discount_type==="percentage"?q("discount_val",C.value*g/100):q("discount_val",Math.round(g*100)),q("discount",g)}}),j=S(()=>C.value-e.itemData.discount_val),V=S(()=>e.currency?e.currency:d.selectedCompanyCurrency),T=S(()=>e.store[e.storeProp].items.length!=1),i=S(()=>Math.round(G.exports.sumBy(e.itemData.taxes,function(g){return g.compound_tax?0:g.amount}))),r=S(()=>Math.round(G.exports.sumBy(e.itemData.taxes,function(g){return g.compound_tax?g.amount:0}))),u=S(()=>i.value+r.value),h={name:{required:L.withMessage($("validation.required"),Q)},quantity:{required:L.withMessage($("validation.required"),Q),minValue:L.withMessage($("validation.qty_must_greater_than_zero"),ge(0)),maxLength:L.withMessage($("validation.amount_maxlength"),oe(20))},price:{required:L.withMessage($("validation.required"),Q),minValue:L.withMessage($("validation.number_length_minvalue"),ge(1)),maxLength:L.withMessage($("validation.price_maxlength"),oe(20))},discount_val:{between:L.withMessage($("validation.discount_maxlength"),Ne(0,S(()=>C.value)))},description:{maxLength:L.withMessage($("validation.notes_maxlength"),oe(65e3))}},M=le(h,S(()=>e.store[e.storeProp].items[e.index]),{$scope:e.itemValidationScope});function x(g){e.store.$patch(O=>{O[e.storeProp].items[e.index].taxes[g.index]=g.item});let P=e.itemData.taxes[e.itemData.taxes.length-1];(P==null?void 0:P.tax_type_id)!==0&&e.store.$patch(O=>{O[e.storeProp].items[e.index].taxes.push(X(z({},Ce),{id:he.raw()}))}),I()}function A(g){q("name",g)}function k(g){e.store.$patch(P=>{if(P[e.storeProp].items[e.index].name=g.name,P[e.storeProp].items[e.index].price=g.price,P[e.storeProp].items[e.index].item_id=g.id,P[e.storeProp].items[e.index].description=g.description,g.unit&&(P[e.storeProp].items[e.index].unit_name=g.unit.name),e.store[e.storeProp].tax_per_item==="YES"&&g.taxes){let O=0;g.taxes.forEach(R=>{x({index:O,item:z({},R)}),O++})}P[e.storeProp].exchange_rate&&(P[e.storeProp].items[e.index].price/=P[e.storeProp].exchange_rate)}),w.fetchItems(),I()}function f(){e.itemData.discount_type!=="fixed"&&(q("discount_val",Math.round(e.itemData.discount*100)),q("discount_type","fixed"))}function b(){e.itemData.discount_type!=="percentage"&&(q("discount_val",C.value*e.itemData.discount/100),q("discount_type","percentage"))}function I(){var O,R;let g=(R=(O=e.store[e.storeProp])==null?void 0:O.items[e.index])==null?void 0:R.taxes;g||(g=[]);let P=X(z({},e.store[e.storeProp].items[e.index]),{index:e.index,total:j.value,sub_total:C.value,totalSimpleTax:i.value,totalCompoundTax:r.value,totalTax:u.value,tax:u.value,taxes:[...g]});e.store.updateItem(P)}function q(g,P){e.store.$patch(O=>{O[e.storeProp].items[e.index][g]=P}),I()}return(g,P)=>{const O=p("BaseItemSelect"),R=p("BaseInput"),E=p("BaseMoney"),ie=p("BaseIcon"),ve=p("BaseButton"),de=p("BaseDropdownItem"),$e=p("BaseDropdown"),ce=p("BaseContentPlaceholdersText"),ue=p("BaseContentPlaceholders"),we=p("BaseFormatMoney");return l(),v("tr",tt,[a("td",st,[a("table",ot,[a("colgroup",null,[nt,at,rt,t.store[t.storeProp].discount_per_item==="YES"?(l(),v("col",lt)):N("",!0),it]),a("tbody",null,[a("tr",null,[a("td",dt,[a("div",ct,[a("div",ut,[n(De)]),n(O,{type:"Invoice",item:t.itemData,invalid:o(M).name.$error,"invalid-description":o(M).description.$error,taxes:t.itemData.taxes,index:t.index,"store-prop":t.storeProp,store:t.store,onSearch:A,onSelect:k},null,8,["item","invalid","invalid-description","taxes","index","store-prop","store"])])]),a("td",mt,[n(R,{modelValue:o(B),"onUpdate:modelValue":P[0]||(P[0]=F=>H(B)?B.value=F:null),invalid:o(M).quantity.$error,"content-loading":t.loading,type:"number",small:"",min:"0",step:"any",onChange:P[1]||(P[1]=F=>I()),onInput:P[2]||(P[2]=F=>o(M).quantity.$touch())},null,8,["modelValue","invalid","content-loading"])]),a("td",pt,[a("div",yt,[a("div",xt,[a("div",ft,[n(E,{key:o(V),modelValue:o(y),"onUpdate:modelValue":P[3]||(P[3]=F=>H(y)?y.value=F:null),invalid:o(M).price.$error,"content-loading":t.loading,currency:o(V)},null,8,["modelValue","invalid","content-loading","currency"])])])])]),t.store[t.storeProp].discount_per_item==="YES"?(l(),v("td",gt,[a("div",ht,[a("div",_t,[n(R,{modelValue:o(m),"onUpdate:modelValue":P[4]||(P[4]=F=>H(m)?m.value=F:null),invalid:o(M).discount_val.$error,"content-loading":t.loading,class:"border-r-0 focus:border-r-2 rounded-tr-sm rounded-br-sm h-[38px]"},null,8,["modelValue","invalid","content-loading"]),n($e,{position:"bottom-end"},{activator:c(()=>[n(ve,{"content-loading":t.loading,class:"rounded-tr-md rounded-br-md !p-2 rounded-none",type:"button",variant:"white"},{default:c(()=>[a("span",bt,[U(_(t.itemData.discount_type=="fixed"?t.currency.symbol:"%")+" ",1),n(ie,{name:"ChevronDownIcon",class:"w-4 h-4 text-gray-500 ml-1"})])]),_:1},8,["content-loading"])]),default:c(()=>[n(de,{onClick:f},{default:c(()=>[U(_(g.$t("general.fixed")),1)]),_:1}),n(de,{onClick:b},{default:c(()=>[U(_(g.$t("general.percentage")),1)]),_:1})]),_:1})])])])):N("",!0),a("td",vt,[a("div",$t,[a("span",null,[t.loading?(l(),D(ue,{key:0},{default:c(()=>[n(ce,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),D(we,{key:1,amount:o(j),currency:o(V)},null,8,["amount","currency"]))]),a("div",wt,[o(T)?(l(),D(ie,{key:0,class:"h-5 text-gray-700 cursor-pointer",name:"TrashIcon",onClick:P[5]||(P[5]=F=>t.store.removeItem(t.index))})):N("",!0)])])])]),t.store[t.storeProp].tax_per_item==="YES"?(l(),v("tr",St,[Bt,a("td",It,[t.loading?(l(),D(ue,{key:0},{default:c(()=>[n(ce,{lines:1,class:"w-24 h-8 rounded-md border"})]),_:1})):(l(!0),v(K,{key:1},se(t.itemData.taxes,(F,Se)=>(l(),D(et,{key:F.id,index:Se,"item-index":t.index,"tax-data":F,taxes:t.itemData.taxes,"discounted-total":o(j),"total-tax":o(i),total:o(C),currency:t.currency,"update-items":I,ability:o(ne).CREATE_INVOICE,store:t.store,"store-prop":t.storeProp,onUpdate:x},null,8,["index","item-index","tax-data","taxes","discounted-total","total-tax","total","currency","ability","store","store-prop"]))),128))])])):N("",!0)])])])])}}},Tt={class:"text-center item-table min-w-full"},kt=a("col",{style:{width:"40%","min-width":"280px"}},null,-1),Ct=a("col",{style:{width:"10%","min-width":"120px"}},null,-1),Mt=a("col",{style:{width:"15%","min-width":"120px"}},null,-1),At={key:0,style:{width:"15%","min-width":"160px"}},Vt=a("col",{style:{width:"15%","min-width":"120px"}},null,-1),Dt={class:"bg-white border border-gray-200 border-solid"},jt={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},qt={key:1,class:"pl-7"},Ut={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-right text-gray-700 border-t border-b border-gray-200 border-solid"},Nt={key:1},Ot={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},Lt={key:1},Et={key:0,class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-left text-gray-700 border-t border-b border-gray-200 border-solid"},zt={key:1},Ft={class:"px-5 py-3 text-sm not-italic font-medium leading-5 text-right text-gray-700 border-t border-b border-gray-200 border-solid"},Rt={key:1,class:"pr-10 column-heading"},Gs={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},currency:{type:[Object,String,null],required:!0},isLoading:{type:Boolean,default:!1},itemValidationScope:{type:String,default:""}},setup(t){const s=t,e=te(),d=S(()=>s.currency?s.currency:e.selectedCompanyCurrency);return(w,$)=>{const B=p("BaseContentPlaceholdersText"),y=p("BaseContentPlaceholders"),C=p("BaseIcon");return l(),v(K,null,[a("table",Tt,[a("colgroup",null,[kt,Ct,Mt,t.store[t.storeProp].discount_per_item==="YES"?(l(),v("col",At)):N("",!0),Vt]),a("thead",Dt,[a("tr",null,[a("th",jt,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[n(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",qt,_(w.$tc("items.item",2)),1))]),a("th",Ut,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[n(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",Nt,_(w.$t("invoices.item.quantity")),1))]),a("th",Ot,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[n(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",Lt,_(w.$t("invoices.item.price")),1))]),t.store[t.storeProp].discount_per_item==="YES"?(l(),v("th",Et,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[n(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",zt,_(w.$t("invoices.item.discount")),1))])):N("",!0),a("th",Ft,[t.isLoading?(l(),D(y,{key:0},{default:c(()=>[n(B,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("span",Rt,_(w.$t("invoices.item.amount")),1))])])]),n(o(je),{modelValue:t.store[t.storeProp].items,"onUpdate:modelValue":$[0]||($[0]=m=>t.store[t.storeProp].items=m),"item-key":"id",tag:"tbody",handle:".handle"},{item:c(({element:m,index:j})=>[n(Pt,{key:m.id,index:j,"item-data":m,loading:t.isLoading,currency:o(d),"item-validation-scope":t.itemValidationScope,"invoice-items":t.store[t.storeProp].items,store:t.store,"store-prop":t.storeProp},null,8,["index","item-data","loading","currency","item-validation-scope","invoice-items","store","store-prop"])]),_:1},8,["modelValue"])]),a("div",{class:"flex items-center justify-center w-full px-6 py-3 text-base border border-t-0 border-gray-200 border-solid cursor-pointer text-primary-400 hover:bg-primary-100",onClick:$[1]||($[1]=(...m)=>t.store.addItem&&t.store.addItem(...m))},[n(C,{name:"PlusCircleIcon",class:"mr-2"}),U(" "+_(w.$t("general.add_new_item")),1)])],64)}}},Xt={class:"flex items-center justify-between w-full mt-2 text-sm"},Yt={class:"font-semibold leading-5 text-gray-500 uppercase"},Qt={class:"flex items-center justify-center text-lg text-black"},Wt={props:{index:{type:Number,required:!0},tax:{type:Object,required:!0},taxes:{type:Array,required:!0},currency:{type:[Object,String],required:!0},store:{type:Object,default:null},data:{type:String,default:""}},emits:["update","remove"],setup(t,{emit:s}){const e=t;ae("$utils");const d=S(()=>e.tax.compound_tax&&e.store.getSubtotalWithDiscount?Math.round((e.store.getSubtotalWithDiscount+e.store.getTotalSimpleTax)*e.tax.percent/100):e.store.getSubtotalWithDiscount&&e.tax.percent?Math.round(e.store.getSubtotalWithDiscount*e.tax.percent/100):0);Oe(()=>{e.store.getSubtotalWithDiscount&&w(),e.store.getTotalSimpleTax&&w()});function w(){s("update",X(z({},e.tax),{amount:d.value}))}return($,B)=>{const y=p("BaseFormatMoney"),C=p("BaseIcon");return l(),v("div",Xt,[a("label",Yt,_(t.tax.name)+" ("+_(t.tax.percent)+" %) ",1),a("label",Qt,[n(y,{amount:t.tax.amount,currency:t.currency},null,8,["amount","currency"]),n(C,{name:"TrashIcon",class:"h-5 ml-2 cursor-pointer",onClick:B[0]||(B[0]=m=>$.$emit("remove",t.tax.id))})])])}}},Jt={class:"w-full mt-4 tax-select"},Zt={class:"relative w-full max-w-md px-4"},Gt={class:"overflow-hidden rounded-md shadow-lg ring-1 ring-black ring-opacity-5"},Ht={class:"relative bg-white"},Kt={class:"relative p-4"},es={key:0,class:"relative flex flex-col overflow-auto list max-h-36 border-t border-gray-200"},ts=["onClick"],ss={class:"flex justify-between px-2"},os={class:"m-0 text-base font-semibold leading-tight text-gray-700 cursor-pointer"},ns={class:"m-0 text-base font-semibold text-gray-700 cursor-pointer"},as={key:1,class:"flex justify-center p-5 text-gray-400"},rs={class:"text-base text-gray-500 cursor-pointer"},ls={class:"m-0 ml-3 text-sm leading-none cursor-pointer font-base text-primary-400"},is={props:{type:{type:String,default:null},store:{type:Object,default:null},storeProp:{type:String,default:""}},emits:["select:taxType"],setup(t,{emit:s}){const e=t,d=J(),w=ee(),$=ye(),{t:B}=Z(),y=Y(null),C=S(()=>y.value?w.taxTypes.filter(function(T){return T.name.toLowerCase().indexOf(y.value.toLowerCase())!==-1}):w.taxTypes),m=S(()=>e.store[e.storeProp].taxes);function j(T,i){s("select:taxType",z({},T)),i()}function V(){d.openModal({title:B("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:T=>s("select:taxType",T)})}return(T,i)=>{const r=p("BaseIcon"),u=p("BaseInput");return l(),v("div",Jt,[n(o(Fe),{class:"relative"},{default:c(({isOpen:h})=>[n(o(Le),{class:W([h?"":"text-opacity-90","flex items-center text-sm font-medium text-primary-400 focus:outline-none focus:border-none"])},{default:c(()=>[n(r,{name:"PlusIcon",class:"w-4 h-4 font-medium text-primary-400"}),U(" "+_(T.$t("settings.tax_types.add_tax")),1)]),_:2},1032,["class"]),a("div",Zt,[n(Ee,{"enter-active-class":"transition duration-200 ease-out","enter-from-class":"translate-y-1 opacity-0","enter-to-class":"translate-y-0 opacity-100","leave-active-class":"transition duration-150 ease-in","leave-from-class":"translate-y-0 opacity-100","leave-to-class":"translate-y-1 opacity-0"},{default:c(()=>[n(o(ze),{style:{"min-width":"350px","margin-left":"62px",top:"-28px"},class:"absolute z-10 px-4 py-2 -translate-x-full sm:px-0"},{default:c(({close:M})=>[a("div",Gt,[a("div",Ht,[a("div",Kt,[n(u,{modelValue:y.value,"onUpdate:modelValue":i[0]||(i[0]=x=>y.value=x),placeholder:T.$t("general.search"),type:"text",class:"text-black"},null,8,["modelValue","placeholder"])]),o(C).length>0?(l(),v("div",es,[(l(!0),v(K,null,se(o(C),(x,A)=>(l(),v("div",{key:A,class:W([{"bg-gray-100 cursor-not-allowed opacity-50 pointer-events-none":o(m).find(k=>k.tax_type_id===x.id)},"px-6 py-4 border-b border-gray-200 border-solid cursor-pointer hover:bg-gray-100 hover:cursor-pointer last:border-b-0"]),tabindex:"2",onClick:k=>j(x,M)},[a("div",ss,[a("label",os,_(x.name),1),a("label",ns,_(x.percent)+" % ",1)])],10,ts))),128))])):(l(),v("div",as,[a("label",rs,_(T.$t("general.no_tax_found")),1)]))]),o($).hasAbilities(o(ne).CREATE_TAX_TYPE)?(l(),v("button",{key:0,type:"button",class:"flex items-center justify-center w-full h-10 px-2 py-3 bg-gray-200 border-none outline-none",onClick:V},[n(r,{name:"CheckCircleIcon",class:"text-primary-400"}),a("label",ls,_(T.$t("estimates.add_new_tax")),1)])):N("",!0)])]),_:1})]),_:1})])]),_:1})])}}},ds={class:"px-5 py-4 mt-6 bg-white border border-gray-200 border-solid rounded md:min-w-[390px] min-w-[300px] lg:mt-7"},cs={class:"flex items-center justify-between w-full"},us={key:1,class:"text-sm font-semibold leading-5 text-gray-400 uppercase"},ms={key:3,class:"flex items-center justify-center m-0 text-lg text-black uppercase"},ps={key:1,class:"m-0 text-sm font-semibold leading-5 text-gray-500 uppercase"},ys={key:3,class:"flex items-center justify-center m-0 text-lg text-black uppercase"},xs={key:0,class:"flex items-center justify-between w-full mt-2"},fs={key:1,class:"text-sm font-semibold leading-5 text-gray-400 uppercase"},gs={key:3,class:"flex",style:{width:"140px"},role:"group"},hs={class:"flex items-center"},_s={key:1},bs={class:"flex items-center justify-between w-full pt-2 mt-5 border-t border-gray-200 border-solid"},vs={key:1,class:"m-0 text-sm font-semibold leading-5 text-gray-400 uppercase"},$s={key:3,class:"flex items-center justify-center text-lg uppercase text-primary-400"},Hs={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},taxPopupType:{type:String,default:""},currency:{type:[Object,String],default:""},isLoading:{type:Boolean,default:!1}},setup(t){const s=t,e=Y(null);ae("$utils");const d=te(),w=S({get:()=>s.store[s.storeProp].discount,set:i=>{s.store[s.storeProp].discount_type==="percentage"?s.store[s.storeProp].discount_val=Math.round(s.store.getSubTotal*i/100):s.store[s.storeProp].discount_val=Math.round(i*100),s.store[s.storeProp].discount=i}}),$=S({get:()=>s.store[s.storeProp].taxes,set:i=>{s.store.$patch(r=>{r[s.storeProp].taxes=i})}}),B=S(()=>{let i=[];return s.store[s.storeProp].items.forEach(r=>{r.taxes&&r.taxes.forEach(u=>{let h=i.find(M=>M.tax_type_id===u.tax_type_id);h?h.amount+=u.amount:u.tax_type_id&&i.push({tax_type_id:u.tax_type_id,amount:u.amount,percent:u.percent,name:u.name})})}),i}),y=S(()=>s.currency?s.currency:d.selectedCompanyCurrency);function C(){s.store[s.storeProp].discount_type!=="fixed"&&(s.store[s.storeProp].discount_val=Math.round(s.store[s.storeProp].discount*100),s.store[s.storeProp].discount_type="fixed")}function m(){s.store[s.storeProp].discount_type!=="percentage"&&(s.store[s.storeProp].discount_val=s.store.getSubTotal*s.store[s.storeProp].discount/100,s.store[s.storeProp].discount_type="percentage")}function j(i){let r=0;i.compound_tax&&s.store.getSubtotalWithDiscount?r=Math.round((s.store.getSubtotalWithDiscount+s.store.getTotalSimpleTax)*i.percent/100):s.store.getSubtotalWithDiscount&&i.percent&&(r=Math.round(s.store.getSubtotalWithDiscount*i.percent/100));let u=X(z({},ne),{id:he.raw(),name:i.name,percent:i.percent,compound_tax:i.compound_tax,tax_type_id:i.id,amount:r});s.store.$patch(h=>{h[s.storeProp].taxes.push(z({},u))})}function V(i){const r=s.store[s.storeProp].taxes.find(u=>u.id===i.id);r&&Object.assign(r,z({},i))}function T(i){const r=s.store[s.storeProp].taxes.findIndex(u=>u.id===i);s.store.$patch(u=>{u[s.storeProp].taxes.splice(r,1)})}return(i,r)=>{const u=p("BaseContentPlaceholdersText"),h=p("BaseContentPlaceholders"),M=p("BaseFormatMoney"),x=p("BaseInput"),A=p("BaseIcon"),k=p("BaseButton"),f=p("BaseDropdownItem"),b=p("BaseDropdown");return l(),v("div",ds,[a("div",cs,[t.isLoading?(l(),D(h,{key:0},{default:c(()=>[n(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",us,_(i.$t("estimates.sub_total")),1)),t.isLoading?(l(),D(h,{key:2},{default:c(()=>[n(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",ms,[n(M,{amount:t.store.getSubTotal,currency:o(y)},null,8,["amount","currency"])]))]),(l(!0),v(K,null,se(o(B),I=>(l(),v("div",{key:I.tax_type_id,class:"flex items-center justify-between w-full"},[t.isLoading?(l(),D(h,{key:0},{default:c(()=>[n(u,{lines:1,class:"w-16 h-5"})]),_:1})):t.store[t.storeProp].tax_per_item==="YES"?(l(),v("label",ps,_(I.name)+" - "+_(I.percent)+"% ",1)):N("",!0),t.isLoading?(l(),D(h,{key:2},{default:c(()=>[n(u,{lines:1,class:"w-16 h-5"})]),_:1})):t.store[t.storeProp].tax_per_item==="YES"?(l(),v("label",ys,[n(M,{amount:I.amount,currency:o(y)},null,8,["amount","currency"])])):N("",!0)]))),128)),t.store[t.storeProp].discount_per_item==="NO"||t.store[t.storeProp].discount_per_item===null?(l(),v("div",xs,[t.isLoading?(l(),D(h,{key:0},{default:c(()=>[n(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",fs,_(i.$t("estimates.discount")),1)),t.isLoading?(l(),D(h,{key:2},{default:c(()=>[n(u,{lines:1,class:"w-24 h-8 rounded-md border"})]),_:1})):(l(),v("div",gs,[n(x,{modelValue:o(w),"onUpdate:modelValue":r[0]||(r[0]=I=>H(w)?w.value=I:null),class:"border-r-0 focus:border-r-2 rounded-tr-sm rounded-br-sm h-[38px]"},null,8,["modelValue"]),n(b,{position:"bottom-end"},{activator:c(()=>[n(k,{class:"rounded-tr-md rounded-br-md p-2 rounded-none",type:"button",variant:"white"},{default:c(()=>[a("span",hs,[U(_(t.store[t.storeProp].discount_type=="fixed"?o(y).symbol:"%")+" ",1),n(A,{name:"ChevronDownIcon",class:"w-4 h-4 text-gray-500 ml-1"})])]),_:1})]),default:c(()=>[n(f,{onClick:C},{default:c(()=>[U(_(i.$t("general.fixed")),1)]),_:1}),n(f,{onClick:m},{default:c(()=>[U(_(i.$t("general.percentage")),1)]),_:1})]),_:1})]))])):N("",!0),t.store[t.storeProp].tax_per_item==="NO"||t.store[t.storeProp].tax_per_item===null?(l(),v("div",_s,[(l(!0),v(K,null,se(o($),(I,q)=>(l(),D(Wt,{key:I.id,index:q,tax:I,taxes:o($),currency:t.currency,store:t.store,onRemove:T,onUpdate:V},null,8,["index","tax","taxes","currency","store"]))),128))])):N("",!0),t.store[t.storeProp].tax_per_item==="NO"||t.store[t.storeProp].tax_per_item===null?(l(),v("div",{key:2,ref:(I,q)=>{q.taxModal=I,e.value=I},class:"float-right pt-2 pb-4"},[n(is,{"store-prop":t.storeProp,store:t.store,type:t.taxPopupType,"onSelect:taxType":j},null,8,["store-prop","store","type"])],512)):N("",!0),a("div",bs,[t.isLoading?(l(),D(h,{key:0},{default:c(()=>[n(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",vs,_(i.$t("estimates.total"))+" "+_(i.$t("estimates.amount"))+":",1)),t.isLoading?(l(),D(h,{key:2},{default:c(()=>[n(u,{lines:1,class:"w-16 h-5"})]),_:1})):(l(),v("label",$s,[n(M,{amount:t.store.getTotal,currency:o(y)},null,8,["amount","currency"])]))])])}}},ws={class:"flex text-gray-800 font-medium text-sm mb-2"},Ss=a("span",{class:"text-sm text-red-500"}," *",-1),Ks={props:{store:{type:Object,default:null},storeProp:{type:String,default:""}},setup(t){const s=t,e=J(),{t:d}=Z();function w(){e.openModal({title:d("general.choose_template"),componentName:"SelectTemplate",data:{templates:s.store.templates,store:s.store,storeProp:s.storeProp}})}return($,B)=>{const y=p("BaseIcon"),C=p("BaseButton");return l(),v("div",null,[a("label",ws,[U(_($.$t("general.select_template"))+" ",1),Ss]),n(C,{type:"button",class:"flex justify-center w-full text-sm lg:w-auto hover:bg-gray-200",variant:"gray",onClick:w},{right:c(m=>[n(y,{name:"PencilIcon",class:W(m.class)},null,8,["class"])]),default:c(()=>[U(" "+_(t.store[t.storeProp].template_name),1)]),_:1})])}}},Bs={class:"mb-6"},Is={class:"z-20 text-sm font-semibold leading-5 text-primary-400 float-right"},Ps={class:"text-gray-800 font-medium mb-4 text-sm"},eo={props:{store:{type:Object,default:null},storeProp:{type:String,default:""},fields:{type:Object,default:null},type:{type:String,default:null}},setup(t){const s=t;function e(d){s.store[s.storeProp].notes=""+d.notes}return(d,w)=>{const $=p("BaseCustomInput");return l(),v("div",Bs,[a("div",Is,[n(Xe,{type:t.type,onSelect:e},null,8,["type"])]),a("label",Ps,_(d.$t("invoices.notes")),1),n($,{modelValue:t.store[t.storeProp].notes,"onUpdate:modelValue":w[0]||(w[0]=B=>t.store[t.storeProp].notes=B),"content-loading":t.store.isFetchingInitialSettings,fields:t.fields,class:"mt-1"},null,8,["modelValue","content-loading","fields"])])}}},Ts={class:"flex justify-between w-full"},ks={class:"px-8 py-8 sm:p-6"},Cs={key:0,class:"grid grid-cols-3 gap-2 p-1 overflow-x-auto"},Ms=["src","alt","onClick"],As=["alt","src"],Vs={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},to={setup(t){const s=J(),e=Y(""),d=S(()=>s.active&&s.componentName==="SelectTemplate"),w=S(()=>s.title);function $(){s.data.store[s.data.storeProp].template_name?e.value=s.data.store[s.data.storeProp].template_name:e.value=s.data.templates[0]}async function B(){await s.data.store.setTemplate(e.value),C()}function y(){return new URL("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACoAAAAqCAYAAADFw8lbAAAACXBIWXMAABYlAAAWJQFJUiTwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAANDSURBVHgB1ZnPTxNBFMe/b4AExUQSlXjRbDxoTEwsifEo5S9gjRrQg4onL0b+AUTkHwBP3tSLgfgjezDxyPoX0IOJxAtFb/6IvWAxyI7vTbtlC0vplN12+RzohN1hP7zZN515Q2gR113q70VvTqNrBCpwSCNHoH4N3S/XuV0KoIsElKD1R/6VP++d99EiBEvG3M95kVOk74ZSzT+MSprgbQYbc6+9CwW7vhaCIJriZh7J4HOkxznKxWZu3lNUhviQ6pvSOphAChCp2XKwNu15g6WG9zW6yFF0+C8tctNBuhQ5usONoqt2u3DL/ZLj/3YJ6UvCPIMDcsP9lNvthtiIiqQmvWibLPtFku2f3hiOS7Qdom0c7ljMzKCDwe2vQd3QS+J0UlIwo8gOxiVCnahkNzooGcGputSoDX11yFeQJSozgS/NrYgSPUfWqHzBVJryQ6aFLupeQhapRtVEtAs9D5FRNMiVTyNKBBdt4MrwUZwY6LHqo4juyAzQXVkNpT+xXxs9huujx/FnLcDM5FcUi3+b6iduspyUiOaRMqGkcLhPYXLmtE13M/yKx30IKRKVDPnw/jfsCBylgdSGPU7y7cIvvFn4CRt4cXRRcUgdWHL/wUk8fXamYWIkJSnIFkfZJtLtewMYqmbv5JNTsbJJSgriqGw7Xbp8pNaOk01aMkTJssqmw8yjb/jxfQNxsmlJiiONucsr3HJsOsZFUuZHmXqSlqyIoiBZb7VtFSSi2yOblqTAjiXOeqyiBeJkQ5KUNHABQ7LeQ4vEySYuWcFX61gv2CZUlKhsGpLiJss8sx696S7Pcqklm0s9ohfz786NmwzYz/CnjdSp5NOIVvclPrKHH+7xt+YUraeRNbiIFjZrouaF1ZhDRtDsEi1C1M3SZZQfQwpWnYfX/8alRp2oKf3xrm8/01UCmMre9jLkjtWThJs0dURWnqm0uhpXfoxd5r3yzhZEFm18DcwKiZ8pz46/3oADUcgVpOO6Lg+mORtIdssz9qrl2xw2ONX6VB7JIIcN080e6Vgf30g1OsDmBO8MR1o5vgm0fkn8lW175mQtGsUc6UiEuTYg227Z0UYPxLhdIqJCEOhVkZOV2l6nH7vxH+OylVHYXSZdAAAAAElFTkSuQmCC",self.location)}function C(){s.closeModal(),setTimeout(()=>{s.$reset()},300)}return(m,j)=>{const V=p("BaseIcon"),T=p("BaseButton"),i=p("BaseModal");return l(),D(i,{show:o(d),onClose:C,onOpen:$},{header:c(()=>[a("div",Ts,[U(_(o(w))+" ",1),n(V,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:C})])]),default:c(()=>[a("div",ks,[o(s).data?(l(),v("div",Cs,[(l(!0),v(K,null,se(o(s).data.templates,(r,u)=>(l(),v("div",{key:u,class:W([{"border border-solid border-primary-500":e.value===r.name},"relative flex flex-col m-2 border border-gray-200 border-solid cursor-pointer hover:border-primary-300"])},[a("img",{src:r.path,alt:r.name,class:"w-full",onClick:h=>e.value=r.name},null,8,Ms),e.value===r.name?(l(),v("img",{key:0,alt:r.name,class:"absolute z-10 w-5 h-5 text-primary-500",style:{top:"-6px",right:"-5px"},src:y()},null,8,As)):N("",!0),a("span",{class:W(["w-full p-1 bg-gray-200 text-sm text-center absolute bottom-0 left-0",{"text-primary-500 bg-primary-100":e.value===r.name,"text-gray-600":e.value!=r.name}])},_(r.name),3)],2))),128))])):N("",!0)]),a("div",Vs,[n(T,{class:"mr-3",variant:"primary-outline",onClick:C},{default:c(()=>[U(_(m.$t("general.cancel")),1)]),_:1}),n(T,{variant:"primary",onClick:j[0]||(j[0]=r=>B())},{left:c(r=>[n(V,{name:"SaveIcon",class:W(r.class)},null,8,["class"])]),default:c(()=>[U(" "+_(m.$t("general.choose")),1)]),_:1})])]),_:1},8,["show"])}}},Ds={class:"flex justify-between w-full"},js={class:"item-modal"},qs=["onSubmit"],Us={class:"px-8 py-8 sm:p-6"},Ns={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},so={emits:["newItem"],setup(t,{emit:s}){const e=J(),d=xe(),w=te(),$=ee();Me(),Ae();const{t:B}=Z(),y=Y(!1),C=Y(w.selectedCompanySettings.tax_per_item),m=S(()=>e.active&&e.componentName==="ItemModal"),j=S({get:()=>d.currentItem.price/100,set:x=>{d.currentItem.price=Math.round(x*100)}}),V=S({get:()=>d.currentItem.taxes.map(x=>{if(x)return X(z({},x),{tax_type_id:x.id,tax_name:x.name+" ("+x.percent+"%)"})}),set:x=>{d.$patch(A=>{A.currentItem.taxes=x})}}),T=S(()=>C.value==="YES"),i={name:{required:L.withMessage(B("validation.required"),Q),minLength:L.withMessage(B("validation.name_min_length",{count:3}),Re(3))},description:{maxLength:L.withMessage(B("validation.description_maxlength",{count:255}),oe(255))}},r=le(i,S(()=>d.currentItem)),u=S(()=>$.taxTypes.map(x=>X(z({},x),{tax_name:x.name+" ("+x.percent+"%)"})));_e(()=>{r.value.$reset(),d.fetchItemUnits({limit:"all"})});async function h(){if(r.value.$touch(),r.value.$invalid)return!0;let x=X(z({},d.currentItem),{taxes:d.currentItem.taxes.map(k=>({tax_type_id:k.id,amount:j.value*k.percent/100,percent:k.percent,name:k.name,collective_tax:0}))});y.value=!0,await(d.isEdit?d.updateItem:d.addItem)(x).then(k=>{y.value=!1,k.data.data&&e.data&&e.refreshData(k.data.data),M()})}function M(){e.closeModal(),setTimeout(()=>{d.resetCurrentItem(),e.$reset(),r.value.$reset()},300)}return(x,A)=>{const k=p("BaseIcon"),f=p("BaseInput"),b=p("BaseInputGroup"),I=p("BaseMoney"),q=p("BaseMultiselect"),g=p("BaseTextarea"),P=p("BaseInputGrid"),O=p("BaseButton"),R=p("BaseModal");return l(),D(R,{show:o(m),onClose:M},{header:c(()=>[a("div",Ds,[U(_(o(e).title)+" ",1),n(k,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:M})])]),default:c(()=>[a("div",js,[a("form",{action:"",onSubmit:be(h,["prevent"])},[a("div",Us,[n(P,{layout:"one-column"},{default:c(()=>[n(b,{label:x.$t("items.name"),required:"",error:o(r).name.$error&&o(r).name.$errors[0].$message},{default:c(()=>[n(f,{modelValue:o(d).currentItem.name,"onUpdate:modelValue":A[0]||(A[0]=E=>o(d).currentItem.name=E),type:"text",invalid:o(r).name.$error,onInput:A[1]||(A[1]=E=>o(r).name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),n(b,{label:x.$t("items.price")},{default:c(()=>[n(I,{key:o(w).selectedCompanyCurrency,modelValue:o(j),"onUpdate:modelValue":A[2]||(A[2]=E=>H(j)?j.value=E:null),currency:o(w).selectedCompanyCurrency,class:"relative w-full focus:border focus:border-solid focus:border-primary"},null,8,["modelValue","currency"])]),_:1},8,["label"]),n(b,{label:x.$t("items.unit")},{default:c(()=>[n(q,{modelValue:o(d).currentItem.unit_id,"onUpdate:modelValue":A[3]||(A[3]=E=>o(d).currentItem.unit_id=E),label:"name",options:o(d).itemUnits,"value-prop":"id","can-deselect":!1,"can-clear":!1,placeholder:x.$t("items.select_a_unit"),searchable:"","track-by":"id"},null,8,["modelValue","options","placeholder"])]),_:1},8,["label"]),o(T)?(l(),D(b,{key:0,label:x.$t("items.taxes")},{default:c(()=>[n(q,{modelValue:o(V),"onUpdate:modelValue":A[4]||(A[4]=E=>H(V)?V.value=E:null),options:o(u),label:"name","value-prop":"id",class:"w-full","can-deselect":!1,"can-clear":!1,searchable:"","track-by":"id",object:""},null,8,["modelValue","options"])]),_:1},8,["label"])):N("",!0),n(b,{label:x.$t("items.description"),error:o(r).description.$error&&o(r).description.$errors[0].$message},{default:c(()=>[n(g,{modelValue:o(d).currentItem.description,"onUpdate:modelValue":A[5]||(A[5]=E=>o(d).currentItem.description=E),rows:"4",cols:"50",invalid:o(r).description.$error,onInput:A[6]||(A[6]=E=>o(r).description.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1})]),a("div",Ns,[n(O,{class:"mr-3",variant:"primary-outline",type:"button",onClick:M},{default:c(()=>[U(_(x.$t("general.cancel")),1)]),_:1}),n(O,{loading:y.value,disabled:y.value,variant:"primary",type:"submit"},{left:c(E=>[n(k,{name:"SaveIcon",class:W(E.class)},null,8,["class"])]),default:c(()=>[U(" "+_(o(d).isEdit?x.$t("general.update"):x.$t("general.save")),1)]),_:1},8,["loading","disabled"])])],40,qs)])]),_:1},8,["show"])}}},Os={class:"flex justify-between w-full"},Ls={class:"flex flex-col"},Es={class:"text-sm text-gray-500 mt-1"},zs=["onSubmit"],Fs={class:"p-4 sm:p-6"},Rs={class:"z-0 flex justify-end p-4 border-t border-gray-200 border-solid"},Xs={emits:["addTax"],setup(t,{emit:s}){const e=J();Ve();const d=fe({state:"",city:"",address_street_1:"",zip:""}),w=Y(!1),$=ee(),{t:B}=Z(),y=S(()=>e.active&&e.componentName==="TaxationAddressModal"),C=S(()=>({state:{required:L.withMessage(B("validation.required"),Q)},city:{required:L.withMessage(B("validation.required"),Q)},address_street_1:{required:L.withMessage(B("validation.required"),Q)},zip:{required:L.withMessage(B("validation.required"),Q)}})),m=le(C,S(()=>d));async function j(){if(m.value.$touch(),m.value.$invalid)return!0;let i={address:d};e.id&&(i.customer_id=e.id),d.address_street_1=d.address_street_1.replace(/(\r\n|\n|\r)/gm,""),w.value=!0,await $.fetchSalesTax(i).then(r=>{w.value=!1,s("addTax",r.data.data),T()}).catch(r=>{w.value=!1})}function V(){var i,r,u,h;d.state=(i=e==null?void 0:e.data)==null?void 0:i.state,d.city=(r=e==null?void 0:e.data)==null?void 0:r.city,d.address_street_1=(u=e==null?void 0:e.data)==null?void 0:u.address_street_1,d.zip=(h=e==null?void 0:e.data)==null?void 0:h.zip}function T(){e.closeModal()}return(i,r)=>{const u=p("BaseIcon"),h=p("BaseInput"),M=p("BaseInputGroup"),x=p("BaseTextarea"),A=p("BaseInputGrid"),k=p("BaseButton"),f=p("BaseModal");return l(),D(f,{show:o(y),onClose:T,onOpen:V},{header:c(()=>[a("div",Os,[a("div",Ls,[U(_(o(e).title)+" ",1),a("p",Es,_(o(e).content),1)]),n(u,{name:"XIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:T})])]),default:c(()=>[a("form",{onSubmit:be(j,["prevent"])},[a("div",Fs,[n(A,{layout:"one-column"},{default:c(()=>[n(M,{required:"",error:o(m).state.$error&&o(m).state.$errors[0].$message,label:i.$t("customers.state")},{default:c(()=>[n(h,{modelValue:o(d).state,"onUpdate:modelValue":r[0]||(r[0]=b=>o(d).state=b),type:"text",name:"shippingState",class:"mt-1 md:mt-0",invalid:o(m).state.$error,onInput:r[1]||(r[1]=b=>o(m).state.$touch()),placeholder:i.$t("settings.taxations.state_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),n(M,{required:"",error:o(m).city.$error&&o(m).city.$errors[0].$message,label:i.$t("customers.city")},{default:c(()=>[n(h,{modelValue:o(d).city,"onUpdate:modelValue":r[2]||(r[2]=b=>o(d).city=b),type:"text",name:"shippingCity",class:"mt-1 md:mt-0",invalid:o(m).city.$error,onInput:r[3]||(r[3]=b=>o(m).city.$touch()),placeholder:i.$t("settings.taxations.city_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),n(M,{required:"",error:o(m).address_street_1.$error&&o(m).address_street_1.$errors[0].$message,label:i.$t("customers.address")},{default:c(()=>[n(x,{modelValue:o(d).address_street_1,"onUpdate:modelValue":r[4]||(r[4]=b=>o(d).address_street_1=b),rows:"2",cols:"50",class:"mt-1 md:mt-0",invalid:o(m).address_street_1.$error,onInput:r[5]||(r[5]=b=>o(m).address_street_1.$touch()),placeholder:i.$t("settings.taxations.address_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"]),n(M,{required:"",error:o(m).zip.$error&&o(m).zip.$errors[0].$message,label:i.$t("customers.zip_code")},{default:c(()=>[n(h,{modelValue:o(d).zip,"onUpdate:modelValue":r[6]||(r[6]=b=>o(d).zip=b),invalid:o(m).zip.$error,onInput:r[7]||(r[7]=b=>o(m).zip.$touch()),type:"text",class:"mt-1 md:mt-0",placeholder:i.$t("settings.taxations.zip_placeholder")},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error","label"])]),_:1})]),a("div",Rs,[n(k,{class:"mr-3 text-sm",type:"button",variant:"primary-outline",onClick:T},{default:c(()=>[U(_(i.$t("general.cancel")),1)]),_:1}),n(k,{loading:w.value,variant:"primary",type:"submit"},{left:c(b=>[w.value?N("",!0):(l(),D(u,{key:0,name:"SaveIcon",class:W(b.class)},null,8,["class"]))]),default:c(()=>[U(" "+_(i.$t("general.save")),1)]),_:1},8,["loading"])])],40,zs)]),_:1},8,["show"])}}},oo={props:{isEdit:{type:Boolean,default:null},type:{type:String,default:null},customer:{type:[Object],default:null},store:{type:Object,default:null},storeProp:{type:String,default:null}},setup(t){const s=t,e="Sales Tax",d="MODULE",w=J(),$=te(),B=ee(),{t:y}=Z(),C=Y(!1),m=S(()=>s.isEdit?s.store[s.storeProp].sales_tax_address_type==="billing":$.selectedCompanySettings.sales_tax_address_type==="billing"),j=S(()=>$.selectedCompanySettings.sales_tax_us_enabled==="YES"),V=S(()=>s.isEdit?s.store[s.storeProp].sales_tax_type==="customer_level":$.selectedCompanySettings.sales_tax_type==="customer_level"),T=S(()=>s.isEdit?s.store[s.storeProp].sales_tax_type==="company_level":$.selectedCompanySettings.sales_tax_type==="company_level"),i=S(()=>{if(V.value&&r.value){let f=m.value?s.customer.billing:s.customer.shipping;return{address:G.exports.pick(f,["address_street_1","city","state","zip"]),customer_id:s.customer.id}}else if(T.value&&r.value)return{address:G.exports.pick(address,["address_street_1","city","state","zip"])}}),r=S(()=>{var f,b;if(V.value){let I=m.value?(f=s.customer)==null?void 0:f.billing:(b=s.customer)==null?void 0:b.shipping;return u(I)}else if(T.value)return u($.selectedCompany.address);return!1});re(()=>s.customer,(f,b)=>{if(f&&b&&V.value){h(f,b);return}!r.value&&V.value&&f?setTimeout(()=>{M()},500):V.value&&f?x():V.value&&!f&&k()}),_e(()=>{T.value&&(r.value?x():M())});function u(f){return f?f.address_street_1&&f.city&&f.state&&f.zip:!1}function h(f,b){const I=m.value?f.billing:f.shipping,q=m.value?b.billing:b.shipping,g=G.exports.pick(I,["address_street_1","city","state","zip"]),P=G.exports.pick(q,["address_street_1","city","state","zip"]);G.exports.isEqual(g,P)||x()}function M(){var I,q;if(!j.value)return;let f=null,b="";V.value?m.value?(f=(I=s.customer)==null?void 0:I.billing,b=y("settings.taxations.add_billing_address")):(f=(q=s.customer)==null?void 0:q.shipping,b=y("settings.taxations.add_shipping_address")):(f=$.selectedCompany.address,b=y("settings.taxations.add_company_address")),w.openModal({title:b,content:y("settings.taxations.modal_description"),componentName:"TaxationAddressModal",data:f,id:V.value?s.customer.id:""})}async function x(){!j.value||(C.value=!0,await B.fetchSalesTax(i.value).then(f=>{A(f.data.data),C.value=!1}).catch(f=>{f.response.data.error&&setTimeout(()=>{M()},500),C.value=!1}))}function A(f){f.tax_type_id=f.id;const b=s.store[s.storeProp].taxes.findIndex(I=>I.name===e&&I.type===d);b>-1?Object.assign(s.store[s.storeProp].taxes[b],f):s.store[s.storeProp].taxes.push(f)}function k(){const f=s.store[s.storeProp].taxes.findIndex(I=>I.name===e&&I.type===d);f>-1&&s.store[s.storeProp].taxes.splice(f,1);let b=B.taxTypes.findIndex(I=>I.name===e&&I.type===d);b>-1&&B.taxTypes.splice(b,1)}return(f,b)=>(l(),D(Xs,{onAddTax:A}))}};export{to as _,so as a,oo as b,Gs as c,eo as d,Ks as e,Hs as f};
